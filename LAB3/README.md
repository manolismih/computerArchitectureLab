# computerArchitectureLab
_Reports from the lab assignments, for the Computer Architecure course, school of Electrical and Computer Enginneering, AUTH_

## Εργαστήριο 3: Energy-Delay-Area Product Optimization (gem5 + McPAT)

### Βήμα 1

#### Ερώτημα 1
> Η **δυναμική ισχύς (dynamic power)** είναι η ισχύς που ξοδεύεται για την φόρτιση και την αποφόρτιση των χωρητικών φορτίων, όταν το κύκλωμα αλλάζει κατάσταση.
> Είναι ανάλογη της χωρητικότητας του κυκλώματος, της τάσης τροφοδοσίας και της διαφοράς των επιπέδων τάσης μεταξύ των λογικών καταστάσεων.

> Η **ισχύς διαρροής (leakage power)** είναι στατική ισχύς που κατανώλεται λόγω των ρευμάτων διαρροής μέσω των τρανζίτορ, τα οποία λειτουργούν ως μη ιδανικοί διακόπτες.
> Υπάρχουν δύο μηχανισμοί διαρροής και η κλίμακα του καθενα είναι ανάλογη με το πλάτος του τρανζίστορ και εξαρτάται από την λογική κατάσταση της συσκευής.
> Η **διαρροή υποκατωφλίου (subtreshold leakage)** συμβαινει όταν ένα τρανζίστορ βρίκσκεται σε κατάσταση "off" αλλά επιτρέπει ένα μικρό ρεύμα να περάσει διαμέσου
> της εκροής και της πηγής του. Η **διαρροή πύλης (gate leakage)** αναφέρεται στο ρεύμα που διαφεύγει μέσω του ακροδέκτη της πύλης.

Από τα παραπάνω καταλαβαίνουμε ότι αν τρέξουμε δύο διαφορετικά προγράμματα στον ίδιο επεξεργαστή, το μέγεθος που θα μεταβληθεί είναι η δυναμική ισχύς.
Η δυναμική ισχύς αντανακλά "το ποιον του προγράμματος", ενώ η ισχύς διαρροής εξαρτάται μόνο από την αρχιτεκτονική του επεξεργαστή.
Η ισχύς είναι η ενέργεια ανά μονάδα χρόνου, οπότε η μέτρηση της δεν θα επηρεαστεί αν για παράδειγμα βάλουμε το ίδιο πρόγραμμα να τρέξει 1 ή 10 φορές.
Στο σενάριο αυτό, θα επηρεαστεί η συνολική ενέργεια που καταναλώνει ο επεξεργαστής.

#### Ερώτημα 2
Στο συγκεκριμένο ερώτημα μας ενδιαφέρει περισσότερο η ενέργεια και λιγότερο η ισχύς. 
Όπως φαίνεται και από το πρώτο ερώτημα, ένας επεξεργαστής δεν καταναλώνει δυναμική ισχύς όσο βρίσκεται σε αδράνεια.
Επιπλέον, δεν μπορούμε να συγκρίνουμε άμεσα την ισχύ, αλλά πρέπει να υπολογίσουμε την ενέργεια που θα καταναλωθεί για ένα πρόγραμμα,
με βάση την απόδοση κάθε επεξεργαστή, και άρα τον χρόνο για τον οποίο θα βρίσκεται σε πλήρη λειτουργία και θα καταναλωνει δυναμική ισχύ.
Επομένως, πράγματι ο επεξεργαστής των 40W θα μπορούσε τελικά να είναι πιο energy efficient, εάν ολοκληρώνει ταχύτερα τα προγράμματα,
με τρόπο ώστε η συνολική ενέργεια που δαπάνησε να είναι μικρότερη από αυτήν που δαπανάει ο επεργαστής των 5W για τα ίδια προγράμματα.

Το McPAT δεν μπορεί από μόνο του να μας δώσει την απάντηση, γιατί υπολογίζει μόνο την ισχύ και όχι την ενέργεια. 
Αυτό που χρειαζόμαστε επιπλέον είναι ο χρόνος εκτέλεσης των ίδιων προγραμμάτων που τρέχουν στους 2 επεξεργαστές, κάτι που μας δίνει ο gem5.

#### Ερώτημα 3
Για τον xeon, παίρνουμε από την έξοδο του McPAT:
```
Total Leakage = 36.8319 W
Runtime Dynamic = 72.9199 W
```

Αντιστοιχα για τον Α9
```
Total Leakage = 0.108687 W
Runtime Dynamic = 2.96053 W
```

Έστω τώρα ότι μια εφαρμογή τρέχει στον Α9 για 40 δευτερόλεπτα, και η ίδια τρέχει στον xeon για 1 δευτερόλεπτο.
Χονδρικά, ο Α9 θα καταναλώσει `(leakage+dynamic)*40 = 122,76868J` ενώ ο xeon `(leakage+dynamic)*1 + leakage*39 = 1546J`.
Επομένως, ο Xeon δεν είναι πιο energy efficient.

### Βήμα 2

#### Ερώτημα 1
Η τιμή **Area** προκύπτει απευθείας από την έξοδο που μας δίνει ο McPAT. H τιμή **delay** προκύπτει από τα αποτελέσματα που πήραμε από τον gem5, για τα benchmarks που τρέξαμε για την δεύτερη εργασία. Τελικά, η τιμή **energy** πρέπει να υπολογιστεί από το άθροισμα δυναμικής και ισχύος διαρροής, επί τον χρόνο που έτρεξε το πρόγραμμα, όπως ακριβώς στο προηγούμενο βήμα. Για ευκολία, χρησιμοποιήθηκε το έτοιμο script print_energy.py που δόθηκε μαζί με την εκφώνηση.

#### Ερώτημα 2
Η επίδραση κάθε παράγοντα στην τιμή **Area** φαίνεται στο επόμενο γράφημα.

![]('Area.svg')

